trigger:
- master

pool: MyAgent

variables:
 myResourceGroupName: ArielResourceGroup
 subscriptionName: "MSEC_Candidates_Homeworks"
 subscriptionID: "a8108c2b-496c-424d-8347-ecc8afb6384c"
 location: "eastus"
 
steps:
- script: hostname

- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      Get-AzLocation | select Location
      $location = "eastus"
      $resourceGroup = "ArielResourceGroup"
      New-AzResourceGroup -Name $resourceGroup -Location $location
      
#Task 2
#Create an ARM template for storage account
#And create 2 storage accounts
- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
     New-AzResourceGroupDeployment -Name storageaccount_A `
     -ResourceGroupName $resourceGroup `
     -TemplateFile 'azuredeploy.json' `
     -TemplateParameterFile 'azuredeploy.parameters.json'

#Task 3
#Create an ARM template for a Windows server
- task: PowerShell@2
  inputs:
    targetType: 'inline'
    script: |
      New-AzResourceGroupDeployment `
      -Name Deployment_VM `
      -ResourceGroupName $resourceGroup `
      -TemplateFile 'windowsServer.json'






